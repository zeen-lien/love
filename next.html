<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Untuk Kamu</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    @keyframes floatHeart {
      0% {
        transform: translateY(0) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100vh) rotate(360deg);
        opacity: 0;
      }
    }

    @keyframes romanticFadeIn {
      0% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.8);
      }
      100% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
    }

    @keyframes romanticFadeOut {
      0% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
      100% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.8);
      }
    }

    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      25% { transform: scale(1.15); }
      50% { transform: scale(1); }
    }
  </style>
</head>
<body>
  <div class="container glass-effect">
    <h1 id="nicknameDisplay" class="neon-text"></h1>
    <div class="love-message" id="loveMessage" style="display:none;">
      <span id="typedMessage" style="font-size:1.1em; line-height:1.6; display:block; margin-bottom:20px;"></span>
      <div style="margin-top:24px;">
        <button id="surpriseBtn" class="futuristic-btn" style="display:none;">
          <span class="btn-text">Ada Kejutan di Sini</span>
          <span class="btn-glow"></span>
        </button>
      </div>
      <div id="buttonRow">
        <button id="againBtn" class="futuristic-btn">
          <span class="btn-text">Lagi...!!!</span>
          <span class="btn-glow"></span>
        </button>
        <button id="redirectBtn" class="futuristic-btn">
          <span class="btn-text">Kejutan Selanjutnya</span>
          <span class="btn-glow"></span>
        </button>
      </div>
    </div>
    <audio id="bgMusic" src="assets/music/lagu.mp3" loop></audio>
  </div>
  <canvas id="loveCanvas"></canvas>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      if (localStorage.getItem('accessGranted') !== 'true') {
        window.location.href = 'login.html';
        return;
      }

      const canvas = document.getElementById('loveCanvas');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      });

      let stars = [];
      const colors = ['#ffb6d5', '#b6e0fe', '#ffe5b4', '#c1ffd7', '#f7c8ff', '#fff6b4', '#fff'];
      
      function createStar() {
        return {
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          r: 0.7 + Math.random() * 2.5,
          alpha: 0.3 + Math.random() * 0.7,
          alphaDir: Math.random() > 0.5 ? 1 : -1,
          color: colors[Math.floor(Math.random() * colors.length)]
        };
      }

      function animateStars() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        if (stars.length < 100) stars.push(createStar());
        
        stars.forEach(s => {
          ctx.save();
          ctx.globalAlpha = s.alpha;
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.r, 0, 2 * Math.PI);
          ctx.fillStyle = s.color;
          ctx.shadowColor = s.color;
          ctx.shadowBlur = 8;
          ctx.fill();
          ctx.restore();

          s.alpha += 0.008 * s.alphaDir;
          if (s.alpha > 1) { s.alpha = 1; s.alphaDir = -1; }
          if (s.alpha < 0.15) { s.alpha = 0.15; s.alphaDir = 1; }
        });
        requestAnimationFrame(animateStars);
      }
      animateStars();

      const nickname = localStorage.getItem('nickname') || 'Sayang';
      const nicknameDisplay = document.getElementById('nicknameDisplay');
      const loveMessage = document.getElementById('loveMessage');
      const bgMusic = document.getElementById('bgMusic');
      const typedMessage = document.getElementById('typedMessage');
      nicknameDisplay.textContent = `Hai, ${nickname}!`;
      
      const message = `Aku cuma mau bilang, aku bersyukur banget punya kamu. Makasih udah selalu ada buat aku. Aku sayang kamu!`;
      
      const secretMessages = [
        'Aku selalu rindu kamu setiap saat',
        'Kamu adalah alasan aku tersenyum setiap hari',
        'Semoga kita selalu bersama selamanya',
        'Terima kasih sudah jadi yang terbaik buat aku',
        'Aku nggak pernah bosen bilang sayang ke kamu',
        'Kamu itu hadiah terindah buat aku',
        'Aku ingin membahagiakan kamu selalu',
        'Cinta ini nggak akan pernah habis untukmu',
        'Kamu selalu di hati aku',
        'Aku bangga punya kamu',
        'Kamu segalanya buat aku',
        'Aku ingin masa depan bareng kamu',
        'Aku suka semua tentang kamu',
        'Kamu lucu banget',
        'Jangan pernah jauh dari aku ya',
        'Aku ingin memelukmu sekarang',
        'Kamu bikin hari-hariku indah',
        'Aku cinta kamu lebih dari apapun',
        'Kamu selalu spesial di mataku',
        'Aku ingin selalu ada buat kamu'
      ];
      
      let usedSecretMessages = [];
      function getUniqueSecretMessage() {
        if (usedSecretMessages.length === secretMessages.length) usedSecretMessages = [];
        let msg;
        do {
          msg = secretMessages[Math.floor(Math.random() * secretMessages.length)];
        } while (usedSecretMessages.includes(msg));
        usedSecretMessages.push(msg);
        return msg;
      }

      function typeWriter(text, i, speed) {
        if (i < text.length) {
          typedMessage.innerHTML += text.charAt(i);
          setTimeout(() => typeWriter(text, i + 1, speed), speed);
        } else {
          setTimeout(() => {
            document.getElementById('surpriseBtn').style.display = 'inline-block';
          }, 400);
        }
      }

      const surpriseBtn = document.getElementById('surpriseBtn');
      const againBtn = document.getElementById('againBtn');
      const redirectBtn = document.getElementById('redirectBtn');
      const buttonRow = document.getElementById('buttonRow');

      function showSurprise() {
        nicknameDisplay.style.display = 'none';
        showClassicFireworks();
        showFloatingHearts();
        showRomanticMessage();
        
        surpriseBtn.style.display = 'none';
        buttonRow.style.display = 'flex';
      }

      function showFloatingHearts() {
        const heartsContainer = document.createElement('div');
        heartsContainer.style.position = 'fixed';
        heartsContainer.style.top = 0;
        heartsContainer.style.left = 0;
        heartsContainer.style.width = '100vw';
        heartsContainer.style.height = '100vh';
        heartsContainer.style.pointerEvents = 'none';
        heartsContainer.style.zIndex = 2500;
        heartsContainer.style.overflow = 'hidden';
        document.body.appendChild(heartsContainer);

        const heartCount = window.innerWidth <= 600 ? 10 : 15;
        for (let i = 0; i < heartCount; i++) {
          setTimeout(() => {
            const heart = document.createElement('div');
            heart.innerHTML = '❤️';
            const baseSize = window.innerWidth <= 600 ? 15 : 20;
            heart.style.position = 'absolute';
            heart.style.fontSize = (baseSize + Math.random() * 20) + 'px';
            heart.style.left = Math.random() * 100 + '%';
            heart.style.bottom = '-50px';
            heart.style.opacity = '0';
            heart.style.animation = `floatHeart ${3 + Math.random() * 2}s ease-out forwards`;
            heartsContainer.appendChild(heart);

            setTimeout(() => heart.remove(), 5000);
          }, i * 200);
        }

        setTimeout(() => heartsContainer.remove(), 5000);
      }

      function showRomanticMessage() {
        const msg = getUniqueSecretMessage();
        const messageBox = document.createElement('div');
        messageBox.style.position = 'fixed';
        messageBox.style.top = '50%';
        messageBox.style.left = '50%';
        messageBox.style.transform = 'translate(-50%, -50%)';
        messageBox.style.background = 'rgba(10, 10, 10, 0.95)';
        messageBox.style.backdropFilter = 'blur(20px)';
        messageBox.style.border = '2px solid rgba(255, 0, 106, 0.5)';
        messageBox.style.borderRadius = '24px';
        messageBox.style.padding = window.innerWidth <= 600 ? '30px 25px' : '40px 50px';
        messageBox.style.maxWidth = window.innerWidth <= 600 ? '85vw' : '80vw';
        messageBox.style.width = window.innerWidth <= 600 ? '85vw' : 'auto';
        messageBox.style.textAlign = 'center';
        messageBox.style.zIndex = 3500;
        messageBox.style.opacity = '0';
        messageBox.style.animation = 'romanticFadeIn 0.8s ease-out forwards';
        messageBox.style.boxShadow = '0 0 60px rgba(255, 0, 106, 0.4), inset 0 0 30px rgba(255, 0, 106, 0.1)';

        const heartIconSize = window.innerWidth <= 600 ? '45' : '60';
        const heartIcon = document.createElement('div');
        heartIcon.innerHTML = `
          <svg width="${heartIconSize}" height="${heartIconSize}" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-bottom:${window.innerWidth <= 600 ? '15px' : '20px'}; animation: heartbeat 1.5s ease-in-out infinite;">
            <defs>
              <linearGradient id="heartGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#ff006a;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#ffb6d5;stop-opacity:1" />
              </linearGradient>
            </defs>
            <path d="M20.84 4.61C20.3292 4.099 19.7228 3.69364 19.0554 3.41708C18.3879 3.14052 17.6725 2.99817 16.95 2.99817C16.2275 2.99817 15.5121 3.14052 14.8446 3.41708C14.1772 3.69364 13.5708 4.099 13.06 4.61L12 5.67L10.94 4.61C9.9083 3.57831 8.50903 2.99871 7.05 2.99871C5.59096 2.99871 4.19169 3.57831 3.16 4.61C2.1283 5.64169 1.54871 7.04097 1.54871 8.5C1.54871 9.95903 2.1283 11.3583 3.16 12.39L4.22 13.45L12 21.23L19.78 13.45L20.84 12.39C21.351 11.8792 21.7563 11.2728 22.0329 10.6053C22.3095 9.93789 22.4518 9.22248 22.4518 8.5C22.4518 7.77752 22.3095 7.06211 22.0329 6.39464C21.7563 5.72718 21.351 5.12075 20.84 4.61Z" fill="url(#heartGrad)" stroke="#ffb6d5" stroke-width="1.5"/>
          </svg>
        `;

        const messageText = document.createElement('div');
        messageText.textContent = msg;
        messageText.style.fontSize = window.innerWidth <= 600 ? '1.1em' : '1.4em';
        messageText.style.fontFamily = 'Poppins, sans-serif';
        messageText.style.color = '#fff';
        messageText.style.textShadow = '0 0 20px #ffb6d5';
        messageText.style.lineHeight = '1.6';
        messageText.style.fontWeight = '400';

        messageBox.appendChild(heartIcon);
        messageBox.appendChild(messageText);
        document.body.appendChild(messageBox);

        setTimeout(() => {
          messageBox.style.animation = 'romanticFadeOut 0.8s ease-out forwards';
          setTimeout(() => messageBox.remove(), 800);
        }, 3000);
      }

      surpriseBtn.onclick = showSurprise;
      againBtn.onclick = showSurprise;
      
      redirectBtn.onclick = function() {
        const isMobile = window.innerWidth <= 600;
        const confirmBox = document.createElement('div');
        confirmBox.style.position = 'fixed';
        confirmBox.style.top = '50%';
        confirmBox.style.left = '50%';
        confirmBox.style.transform = 'translate(-50%, -50%)';
        confirmBox.style.background = 'rgba(10, 10, 10, 0.95)';
        confirmBox.style.backdropFilter = 'blur(20px)';
        confirmBox.style.border = '2px solid rgba(255, 0, 106, 0.5)';
        confirmBox.style.borderRadius = '24px';
        confirmBox.style.padding = isMobile ? '30px 25px' : '40px 50px';
        confirmBox.style.maxWidth = isMobile ? '85vw' : '80vw';
        confirmBox.style.width = isMobile ? '85vw' : 'auto';
        confirmBox.style.textAlign = 'center';
        confirmBox.style.zIndex = 4000;
        confirmBox.style.opacity = '0';
        confirmBox.style.animation = 'romanticFadeIn 0.5s ease-out forwards';
        confirmBox.style.boxShadow = '0 0 60px rgba(255, 0, 106, 0.4)';

        confirmBox.innerHTML = `
          <h2 style="font-family: Orbitron, sans-serif; color: #fff; text-shadow: 0 0 20px #ff006a; margin-bottom: 15px; font-size: ${isMobile ? '1.3em' : '1.6em'};">Siap lanjut?</h2>
          <p style="color: #ffb6d5; margin-bottom: 30px; font-size: ${isMobile ? '1em' : '1.1em'};">Masih ada kejutan lainnya nih...</p>
          <div style="display: flex; gap: ${isMobile ? '10px' : '15px'}; justify-content: center; flex-direction: ${isMobile ? 'column' : 'row'};">
            <button id="confirmYes" class="futuristic-btn" style="max-width: ${isMobile ? '100%' : '150px'}; width: ${isMobile ? '100%' : 'auto'};">
              <span class="btn-text">Yuk!</span>
              <span class="btn-glow"></span>
            </button>
            <button id="confirmNo" style="background: transparent; color: #888; border: 2px solid #888; border-radius: 12px; padding: 12px 24px; cursor: pointer; font-family: Orbitron, sans-serif; font-weight: 600; transition: all 0.3s; width: ${isMobile ? '100%' : 'auto'};">
              Sebentar
            </button>
          </div>
        `;

        document.body.appendChild(confirmBox);

        document.getElementById('confirmYes').onclick = function() {
          // Fade out musik dengan smooth transition
          const fadeOutInterval = setInterval(() => {
            if (bgMusic.volume > 0.1) {
              bgMusic.volume -= 0.1;
            } else {
              bgMusic.pause();
              bgMusic.volume = 1;
              clearInterval(fadeOutInterval);
            }
          }, 100);

          confirmBox.style.animation = 'romanticFadeOut 0.5s ease-out forwards';
          setTimeout(() => {
            window.location.href = 'next2.html';
          }, 500);
        };

        document.getElementById('confirmNo').onclick = function() {
          confirmBox.style.animation = 'romanticFadeOut 0.5s ease-out forwards';
          setTimeout(() => confirmBox.remove(), 500);
        };

        const noBtn = document.getElementById('confirmNo');
        noBtn.onmouseover = function() {
          this.style.background = '#888';
          this.style.color = '#000';
        };
        noBtn.onmouseout = function() {
          this.style.background = 'transparent';
          this.style.color = '#888';
        };
      };

      function showClassicFireworks() {
        const fireworksCanvas = document.createElement('canvas');
        fireworksCanvas.width = window.innerWidth;
        fireworksCanvas.height = window.innerHeight;
        fireworksCanvas.style.position = 'fixed';
        fireworksCanvas.style.left = 0;
        fireworksCanvas.style.top = 0;
        fireworksCanvas.style.width = '100vw';
        fireworksCanvas.style.height = '100vh';
        fireworksCanvas.style.pointerEvents = 'none';
        fireworksCanvas.style.zIndex = 3000;
        document.body.appendChild(fireworksCanvas);
        
        const ctx = fireworksCanvas.getContext('2d');
        const colors = ['#ffb6d5','#b6e0fe','#ffe5b4','#c1ffd7','#f7c8ff','#fff6b4','#fff','#ff006a','#b6004c','#aaffec'];
        const romanticWords = ['I love you', 'I miss you', 'Sayang', 'Kamu spesial', 'My everything', 'Selalu di hati', 'Cinta', 'Rindu', 'Peluk', 'Kamu lucu', 'Sweetheart', 'Dear', 'Honey', 'My love', 'Forever', 'Always', 'You & Me', 'Together', 'Soulmate', 'My Heart'];
        
        let fireworks = [];
        let wordExplosions = [];
        let frame = 0;
        
        function launchFirework() {
          const x = Math.random() * fireworksCanvas.width * 0.7 + fireworksCanvas.width * 0.15;
          const color = colors[Math.floor(Math.random() * colors.length)];
          fireworks.push({
            x: x,
            y: fireworksCanvas.height,
            vy: -8 - Math.random() * 2,
            exploded: false,
            color: color,
            particles: []
          });
        }
        
        function drawFireworks() {
          ctx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
          
          for (let i = 0; i < fireworks.length; i++) {
            let fw = fireworks[i];
            if (!fw.exploded) {
              ctx.save();
              ctx.beginPath();
              ctx.arc(fw.x, fw.y, 4, 0, 2 * Math.PI);
              ctx.fillStyle = fw.color;
              ctx.shadowColor = fw.color;
              ctx.shadowBlur = 16;
              ctx.fill();
              ctx.restore();
              
              fw.y += fw.vy;
              fw.vy += 0.18;
              
              if (fw.vy > -2) {
                fw.exploded = true;
                const count = 32 + Math.floor(Math.random() * 16);
                for (let j = 0; j < count; j++) {
                  const angle = (2 * Math.PI * j) / count;
                  const speed = 2.5 + Math.random() * 2.5;
                  fw.particles.push({
                    x: fw.x,
                    y: fw.y,
                    vx: Math.cos(angle) * speed,
                    vy: Math.sin(angle) * speed,
                    alpha: 1,
                    color: fw.color,
                    size: 2.5 + Math.random() * 2.5
                  });
                }
                
                const wordCount = 2 + Math.floor(Math.random() * 2);
                let localUsed = [];
                let angleStep = (2 * Math.PI) / wordCount;
                let baseAngle = Math.random() * 2 * Math.PI;
                let radius = 60 + Math.random() * 30;
                
                for (let w = 0; w < wordCount; w++) {
                  let word;
                  do {
                    word = romanticWords[Math.floor(Math.random() * romanticWords.length)];
                  } while (localUsed.includes(word));
                  localUsed.push(word);
                  
                  let angle = baseAngle + w * angleStep + (Math.random() - 0.5) * 0.3;
                  let wordX = fw.x + Math.cos(angle) * radius;
                  let wordY = fw.y + Math.sin(angle) * radius;
                  wordExplosions.push({
                    text: word,
                    x: wordX,
                    y: wordY,
                    alpha: 0,
                    frame: 0
                  });
                }
              }
            } else {
              for (let k = 0; k < fw.particles.length; k++) {
                let p = fw.particles[k];
                ctx.save();
                ctx.globalAlpha = p.alpha;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, 2 * Math.PI);
                ctx.fillStyle = p.color;
                ctx.shadowColor = p.color;
                ctx.shadowBlur = 18;
                ctx.fill();
                ctx.restore();
                
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.04;
                p.alpha -= 0.012 + Math.random() * 0.008;
              }
              fw.particles = fw.particles.filter(pt => pt.alpha > 0.05);
            }
          }
          
          for (let w = 0; w < wordExplosions.length; w++) {
            let we = wordExplosions[w];
            ctx.save();
            ctx.globalAlpha = Math.min(1, we.alpha);
            ctx.font = '600 1.1em Orbitron, Poppins, sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = '#fff';
            ctx.shadowColor = '#ff006a';
            ctx.shadowBlur = 10;
            ctx.fillText(we.text, we.x, we.y - we.frame * 1.1);
            ctx.restore();
            
            if (we.frame < 30) {
              we.alpha += 0.06;
            } else {
              we.alpha -= 0.025;
            }
            we.frame++;
          }
          
          wordExplosions = wordExplosions.filter(we => we.alpha > 0);
          fireworks = fireworks.filter(fw => !fw.exploded || fw.particles.length > 0);
          
          if (frame % 22 === 0 && frame < 180) launchFirework();
          frame++;
          
          if (frame < 340 || wordExplosions.length > 0) {
            requestAnimationFrame(drawFireworks);
          } else {
            document.body.removeChild(fireworksCanvas);
          }
        }
        drawFireworks();
      }

      setTimeout(() => {
        loveMessage.style.display = 'block';
        typedMessage.innerHTML = '';
        typeWriter(message, 0, 38);
        setTimeout(() => {
          bgMusic.currentTime = 0;
          bgMusic.play().catch(() => {});
        }, message.length * 38 + 400);
      }, 3000);
    });
  </script>
</body>
</html>
